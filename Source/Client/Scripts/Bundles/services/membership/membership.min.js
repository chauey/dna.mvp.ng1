(function(){"use strict";function n(n,t,i,r,u,f,e){function c(t){return s(),n.post(h.register,t).then(function(n){return n})}function s(){f.remove("authorizationData");o.isAuth=!1;o.userName="";o.roleId=0;f.clearAll();e.clear()}function l(t){var e="grant_type=password&username="+t.userName+"&password="+t.password+"&client_id=86b6477804ce4ec8b3a17c775160b346",r;return t.useRefreshTokens&&(e=e+"&client_id="+(provider=="Facebook"?u.facebookAuthClientId:provider=="Google"?u.googleAuthClientId:"")),r=i.defer(),n.post(h.token,e,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(n){t.useRefreshTokens?f.set("authorizationData",{token:n.access_token,userName:t.userName,refreshToken:n.refresh_token,useRefreshTokens:!0}):f.set("authorizationData",{token:n.access_token,userName:t.userName,refreshToken:"",useRefreshTokens:!1});o.isAuth=!0;o.userName=t.userName;o.useRefreshTokens=t.useRefreshTokens;o.roleId=t.roleId;r.resolve(n)}).error(function(n){s();r.reject(n)}),r.promise}function a(n,i){var u=2e3,f;i&&(u=0);f=r(function(){r.cancel(f);t.path("/"+n)},u)}function v(){var n=f.get("authorizationData");n&&(o.isAuth=!0,o.userName=n.userName,o.roleId=n.roleId)}function y(){var t=i.defer(),r=f.get("authorizationData"),e;if(r&&r.useRefreshTokens)return e="grant_type=refresh_token&refresh_token="+r.refreshToken+"&client_id="+(provider=="Facebook"?u.facebookAuthClientId:provider=="Google"?u.googleAuthClientId:""),f.remove("authorizationData"),n.post(h.token,e,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(n){f.set("authorizationData",{token:n.access_token,userName:n.userName,refreshToken:n.refresh_token,useRefreshTokens:!0});t.resolve(n)}).error(function(n){s();t.reject(n)}),t.promise}function p(t){var r=i.defer();return n.get(h.obtainAccessToken,{params:{provider:t.provider,externalAccessToken:t.externalAccessToken}}).success(function(n){f.set("authorizationData",{token:n.access_token,userName:n.userName,refreshToken:"",useRefreshTokens:!1});o.isAuth=!0;o.userName=n.userName;o.useRefreshTokens=!1;r.resolve(n)}).error(function(n){s();r.reject(n)}),r.promise}function w(t){var r=i.defer();return n.post(h.registerExternal,t).success(function(n){f.set("authorizationData",{token:n.access_token,userName:n.userName,refreshToken:"",useRefreshTokens:!1});o.isAuth=!0;o.userName=n.userName;o.useRefreshTokens=!1;r.resolve(n)}).error(function(n){s();r.reject(n)}),r.promise}var o={isAuth:!1,userName:"",useRefreshTokens:!1,roleId:0},h={token:"/Token",register:"api/Account/Register",login:"api/Account/Login",obtainAccessToken:"api/Account/ObtainLocalAccessToken",registerExternal:"api/Account/RegisterExternal"};return{register:c,login:l,logout:s,fillAuthData:v,authentication:o,refreshToken:y,obtainAccessToken:p,externalAuthData:{provider:"",userName:"",externalAccessToken:""},registerExternal:w,startTimer:a}}angular.module("app.services.membership").factory("authService",["$http","$location","$q","$timeout","config","localStorageService","zStorage",n])})(),function(){"use strict";function n(n,t,i,r){var u={},f=function(n){n.headers=n.headers||{};var t=i.get("authorizationData");return t&&(n.headers.Authorization="Bearer "+t.token),n},e=function(r){var u=n.defer(),f;return r.status===401?(console.log("Unauthorized. No permission on: "+r.config.url),f=i.get("authorizationData"),f?console.log("Unauthorized. No permission on: "+r.config.url):t.path("/login"),n.reject(r)):(u.reject(r),u.promise)},o=function(n,t){$http=$http||r.get("$http");$http(n).then(function(n){t.resolve(n)},function(n){t.reject(n)})};return u.request=f,u.responseError=e,u}angular.module("app.services.membership").factory("authInterceptorService",["$q","$location","localStorageService","$injector",n])}(),function(){"use strict";function n(n){function i(){return n.get(t.getUserInfo).then(function(n){return n})}function r(i){return n.post(t.updateUserInfo,i).then(function(n){return n})}function u(i){return n.post(t.changePassword,i).then(function(n){return n})}function f(i){return n.post(t.setPassword,i).then(function(n){return n})}function e(i){return n.post(t.addLogin,i).then(function(n){return n})}function o(i){return n.post(t.removeLogin,i).then(function(n){return n})}function s(i){return n.post(t.subscribe,i).then(function(n){return n})}function h(i){return n.post(t.updateSubscription,i).then(function(n){return n})}function c(){return n.get(t.getStripeCustomerInfos).then(function(n){return n})}function l(){return n.get(t.getPlans).then(function(n){return n})}function a(){return n.get(t.getUserCards).then(function(n){return n})}function v(i){return n.post(t.addUserCard,i).then(function(n){return n})}var t={getUserInfo:"api/Account/GetUserInfo",updateUserInfo:"api/Account/UpdateUserInfo",changePassword:"api/Account/ChangePassword",setPassword:"api/Account/SetPassword",addLogin:"api/Account/AddLogin",removeLogin:"api/Account/RemoveLogin",subscribe:"api/Account/Subscribe",getStripeCustomerInfos:"api/Account/UserCurrentSubscriptionPlan",updateSubscription:"api/Account/UpdateSubscription",getPlans:"api/Account/GetPlans",getUserCards:"api/Account/GetUserCards",addUserCard:"api/Account/addUserCard"};return{getUserInfo:i,updateUserInfo:r,changePassword:u,setPassword:f,addLogin:e,removeLogin:o,subscribe:s,getStripeCustomerInfos:c,updateSubscription:h,getPlans:l,getUserCards:a,addUserCard:v}}angular.module("app.services.membership").factory("accountService",["$http",n])}();